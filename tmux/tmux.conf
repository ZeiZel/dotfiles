# ============================================
# BASE CONFIGURATION
# ============================================
source-file ~/.config/tmux/tmux.reset.conf

# True color support Ñ Ð¿Ñ€Ð¾Ð·Ñ€Ð°Ñ‡Ð½Ð¾ÑÑ‚ÑŒÑŽ
set-option -g default-terminal 'tmux-256color'
set-option -ga terminal-overrides ',*256col*:Tc'
set-option -ga terminal-overrides ',*:Ss=\E[%p1%d q:Se=\E[2 q'
set-option -as terminal-overrides ',*:Smulx=\E[4::%p1%dm'

# ============================================
# GENERAL OPTIONS
# ============================================
set-option -g focus-events on
set-option -g renumber-windows on
set-option -sg escape-time 0
set-option -sg repeat-time 600
set-option -g mouse on
set-option -g prefix C-a
set-option -g visual-activity off
set-option -g set-titles on
set-option -g set-titles-string "#S / #W"
set-option -g base-index 1
set-option -g pane-base-index 1
set-option -g detach-on-destroy off
set-option -g history-limit 1000000
set-option -g set-clipboard on
set-option -g status-position top
set-option -g status-interval 1

# ============================================
# GRUVBOX COLORS - TRANSPARENT BACKGROUND
# ============================================
# ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ñ†Ð²ÐµÑ‚Ð° Gruvbox Dark
bg0="#282828"
bg1="#3c3836"
bg2="#504945"
bg3="#665c54"
bg4="#7c6f64"

fg0="#fbf1c7"
fg1="#ebdbb2"
fg2="#d5c4a1"
fg3="#bdae93"
fg4="#a89984"

red="#fb4934"
green="#b8bb26"
yellow="#fabd2f"
blue="#83a598"
purple="#d3869b"
aqua="#8ec07c"
orange="#fe8019"

# ÐŸÑ€Ð¾Ð·Ñ€Ð°Ñ‡Ð½Ñ‹Ð¹ Ñ„Ð¾Ð½ Ð´Ð»Ñ Ð¿Ð°Ð½ÐµÐ»ÐµÐ¹
set-option -g pane-border-style "fg=${bg3}"
set-option -g pane-active-border-style "fg=${orange}"

# Ð¡Ñ‚Ð°Ñ‚ÑƒÑ Ð±Ð°Ñ€ Ñ Ð¿Ñ€Ð¾Ð·Ñ€Ð°Ñ‡Ð½Ð¾ÑÑ‚ÑŒÑŽ
set-option -g status-style "bg=default,fg=${fg1}"
set-option -g status-left-style "bg=default,fg=${fg1}"
set-option -g status-right-style "bg=default,fg=${fg1}"

# Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ
set-option -g message-style "bg=${bg1},fg=${fg1}"
set-option -g message-command-style "bg=${bg1},fg=${fg1}"

# Ð ÐµÐ¶Ð¸Ð¼ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
set-option -g mode-style "bg=${bg3},fg=${orange}"

# ============================================
# WINDOW OPTIONS
# ============================================
set-window-option -g monitor-activity on
set-window-option -g automatic-rename on
set-window-option -g pane-base-index 1
set-window-option -g mouse on
set-window-option -g mode-keys vi

# ============================================
# PLUGINS
# ============================================
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-pain-control'
set -g @plugin 'tmux-plugins/tmux-logging'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'
set -g @plugin 'tmux-plugins/tmux-battery'
set -g @plugin 'tmux-plugins/tmux-cpu'
set -g @plugin 'tmux-plugins/tmux-online-status'

# Navigation
set -g @plugin 'christoomey/vim-tmux-navigator'

# Session management
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'tmux-plugins/tmux-sessionist'
set -g @plugin 'omerxx/tmux-sessionx'

# Utils
set -g @plugin 'sainnhe/tmux-fzf'
set -g @plugin 'laktak/extrakto'
set -g @plugin 'fcsonline/tmux-thumbs'
set -g @plugin 'wfxr/tmux-fzf-url'

# ============================================
# PLUGIN CONFIGURATIONS
# ============================================

# Resurrect
set -g @resurrect-capture-pane-contents 'on'
set -g @resurrect-strategy-nvim 'session'
set -g @resurrect-processes 'ssh psql mysql sqlite3'

# Continuum
set -g @continuum-restore 'on'
set -g @continuum-save-interval '15'

# SessionX
set -g @sessionx-bind 'o'
set -g @sessionx-bind-zo-new-window 'ctrl-y'
set -g @sessionx-auto-accept 'off'
set -g @sessionx-custom-paths '~/projects,~/dotfiles,~/.config'
set -g @sessionx-window-height '85%'
set -g @sessionx-window-width '75%'
set -g @sessionx-zoxide-mode 'on'
set -g @sessionx-filter-current 'false'
set -g @sessionx-preview-enabled 'true'

# FZF URL
set -g @fzf-url-fzf-options '-p 60%,30% --prompt="ðŸ”— " --border-label=" Open URL "'
set -g @fzf-url-history-limit '2000'

# Prefix highlight
set -g @prefix_highlight_fg "${bg0}"
set -g @prefix_highlight_bg "${orange}"
set -g @prefix_highlight_show_copy_mode 'on'
set -g @prefix_highlight_copy_mode_attr "fg=${bg0},bg=${yellow}"

# Battery
set -g @batt_icon_charge_tier8 'ðŸŒ•'
set -g @batt_icon_charge_tier7 'ðŸŒ–'
set -g @batt_icon_charge_tier6 'ðŸŒ–'
set -g @batt_icon_charge_tier5 'ðŸŒ—'
set -g @batt_icon_charge_tier4 'ðŸŒ—'
set -g @batt_icon_charge_tier3 'ðŸŒ˜'
set -g @batt_icon_charge_tier2 'ðŸŒ˜'
set -g @batt_icon_charge_tier1 'ðŸŒ‘'
set -g @batt_color_charge_primary_tier8 "${green}"
set -g @batt_color_charge_primary_tier7 "${green}"
set -g @batt_color_charge_primary_tier6 "${yellow}"
set -g @batt_color_charge_primary_tier5 "${yellow}"
set -g @batt_color_charge_primary_tier4 "${orange}"
set -g @batt_color_charge_primary_tier3 "${orange}"
set -g @batt_color_charge_primary_tier2 "${red}"
set -g @batt_color_charge_primary_tier1 "${red}"

# ============================================
# STATUS BAR - GRUVBOX TRANSPARENT
# ============================================
set -g status-left-length 100
set -g status-right-length 100

# Ð›ÐµÐ²Ð°Ñ Ñ‡Ð°ÑÑ‚ÑŒ (ÑÐµÑÑÐ¸Ñ)
set -g status-left "#[fg=${bg0},bg=${orange},bold] #S #[fg=${orange},bg=default] #{prefix_highlight} "

# ÐŸÑ€Ð°Ð²Ð°Ñ Ñ‡Ð°ÑÑ‚ÑŒ (ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ)
set -g status-right "#[fg=${fg4},bg=default] ó°› #(cd #{pane_current_path}; git rev-parse --abbrev-ref HEAD 2>/dev/null) #[fg=${aqua}] #{cpu_percentage} #[fg=${yellow}] #{battery_icon} #{battery_percentage} #[fg=${blue}] %H:%M #[fg=${bg0},bg=${green},bold] #H "

# Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚ Ð¾ÐºÐ¾Ð½
set -g window-status-format "#[fg=${fg4},bg=default] #I:#W#{?window_zoomed_flag,  ,} "
set -g window-status-current-format "#[fg=${bg0},bg=${yellow},bold] #I:#W#{?window_zoomed_flag, ó°Š“ ,} "

set -g window-status-separator ""

# ============================================
# TPM INITIALIZATION
# ============================================
if "test ! -d ~/.config/tmux/plugins/tpm" \
   "run 'git clone https://github.com/tmux-plugins/tpm ~/.config/tmux/plugins/tpm && ~/.config/tmux/plugins/tpm/bin/install_plugins'"

run '~/.config/tmux/plugins/tpm/tpm'
